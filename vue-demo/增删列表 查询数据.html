<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>增删列表 查询过滤数据</title>
    <link rel="stylesheet" href="./bower_components/bootstrap/dist/css/bootstrap.min.css">
    <style>
       [v-cloak] {
            display:none !important;
        }

        .self-mar {
            margin: 25px 0;
        }
    </style>
</head>
<body>
    <div id="app">

        
       
        

        <div class="container">


                <nav class="navbar navbar-default" role="navigation">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">国产汽车品牌列表</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse navbar-ex1-collapse">
            
                <form class="navbar-form" role="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="请输入关键字" v-model="keywords" v-focus>
                    </div>
                </form>
              
                </div><!-- /.navbar-collapse -->
                </nav>
               
                
                <form class="form-inline self-mar">
                
                    <div class="form-group">
                        <label class="sr-only" for="">label</label>
                        <input type="text" class="form-control" id="" placeholder="输入汽车品牌" v-model="brandName">
                    </div>

                    <div class="form-group">
                        <label class="sr-only" for="">label</label>
                        <input type="text" class="form-control" id="" placeholder="输入销售金额" v-model="saleSum">
                    </div>
                
                    
                    <input type="button" @click="add()" class="btn btn-primary" value="添加">
                </form>
                

                <table class="table table-hover table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Brand</th>
                            <th>Sale</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(val,i) in search(keywords)">
                            <td v-cloak>{{ i < 9 ? '0'+(i+1):i+1 }}</td>
                            <td v-cloak>{{val.brand}}</td>
                            <td v-cloak>{{val.sale}}</td>
                            <td>
                                
                                <button type="button" class="btn btn-sm btn-danger" @click="remove(i)">删除</button>
                            
                            </td>
                        </tr>
                        <tr colspan="4" v-if="brandList.length===0">
                            <td class="text-center text-muted" colspan="4">暂无数据...</td>
                        </tr>
                    </tbody>
                </table>
                
        </div>
    </div>
    

    <script src="./bower_components/vue/dist/vue.js"></script>
    <script src="./libs/vue-resource/vue-resource.js"></script>
    <script>

        Vue.directive('focus',{
            inserted: (el) => {
                el.focus();
            }
        });

        new Vue({
            data: {
                brandList: [
                    {brand: '奇瑞汽车',sale: '300,000万'},
                    {brand: '长城汽车',sale: '4,256,321万'},
                    {brand: '长安汽车',sale: '789,156万'},
                    {brand: '吉利汽车',sale: '1,237,891万'},
                    {brand: '上汽汽车',sale: '5,564,326万'}
                ],
                saleSum: '',
                brandName: '',
                keywords: '',
                nowIndex: ''
            },
            methods: {
                add(){
                    if(this.saleSum == "" || this.brandName == ""){
                        alert("输入不能为空！");
                        return;
                    }
                    this.brandList.push({brand: this.brandName,sale: this.saleSum});
                    this.saleSum = "";
                    this.brandName = "";
                },
                remove(i){
                    this.brandList.splice(i,1);
                },
                search(keywords){ // 在这方法内部 执行for循环 把所有符合关键字的数据保存到新对象中，形成新的数组，返回到循环体
                    // var newList = [];
                    // this.brandList.forEach(element => {
                    //     if(element.brand.indexOf(keywords) != -1){
                    //         newList.push(element);
                    //     }
                    //     
                    // });

                        // 这里用的是新方法  some  findIndex  filter(返回的是一个新数组) forEach 
                    return this.brandList.filter(element => {
                        if(element.brand.includes(keywords)){
                            return element;  
                            // 注意如果input中没有输入任何东西就是空字符串，但是空字符串也是返回的是 true，所以相当于把原来的数组重新放回原处
                        }
                    });

                    
                }
            }
        }).$mount('#app');
    </script>

</body>
</html>